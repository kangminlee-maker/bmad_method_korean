# 브라운필드에서 작업하기: 완전한 가이드

> **강력 권장: 브라운필드 문서 생성에 Gemini Web 또는 Gemini CLI를 사용하세요!**
>
> Gemini Web의 1M+ 토큰 컨텍스트 윈도우 또는 Gemini CLI(작동할 때)는 전체 코드베이스나 중요한 섹션을 한 번에 분석할 수 있습니다(합리적인 범위 내에서):
>
> - GitHub URL을 통해 업로드하거나 프로젝트 폴더에서 gemini cli 사용
> - 웹에서 작업하는 경우: `npx bmad-method flatten`을 사용하여 프로젝트를 단일 파일로 플랫화한 다음, 해당 파일을 웹 에이전트에 업로드하세요.

## 브라운필드 개발이란?

브라운필드 개발은 기존 소프트웨어 프로젝트에 기능을 추가하거나, 버그를 수정하거나, 현대화하는 것을 의미합니다. 그린필드(신규) 프로젝트와 달리, 브라운필드 작업은 기존 코드를 이해하고, 제약사항을 존중하며, 기존 기능을 손상시키지 않고 새로운 변경사항이 원활하게 통합되도록 보장해야 합니다.

## BMad를 브라운필드에 사용해야 할 때

- 기존 애플리케이션에 중요한 새 기능 추가
- 레거시 코드베이스 현대화
- 새로운 기술이나 서비스 통합
- 복잡한 시스템 리팩토링
- 아키텍처 이해가 필요한 버그 수정
- 문서화되지 않은 시스템 문서화

## 브라운필드 플로우를 사용하지 말아야 할 때

BMad로 MVP를 막 완료했고 MVP 이후를 계속하고 싶다면, PM과 대화하여 PRD에 추가할 새로운 에픽을 생성하고, 에픽을 샤딩하고, 아키텍트와 함께 아키텍처 문서를 업데이트한 다음 계속 진행하는 것이 더 쉽습니다.

## 완전한 브라운필드 워크플로우

1. **[<ins>사용자 가이드 - 설치</ins>](사용자가이드.md#설치) 단계를 따라 웹에서 에이전트를 설정하세요.**
2. **전체 코드베이스의 '플랫화된' 단일 파일 생성** 실행: `npx bmad-method flatten`

### 접근 방식 선택

#### 접근 방식 A: PRD 우선 (매우 크고 복잡한 새 기능, 단일 또는 여러 에픽, 대규모 변경을 추가하는 경우 권장)

**적합한 경우**: 대규모 코드베이스, 모노레포, 또는 무엇을 구축할지 정확히 알고 있을 때

1. **먼저 PRD 생성**으로 요구사항 정의
2. **PRD 필요에 따라 관련 영역만 문서화**
3. **더 효율적** - 사용하지 않는 코드 문서화 방지

#### 접근 방식 B: 문서 우선 (작은 프로젝트에 적합)

**적합한 경우**: 작은 코드베이스, 알려지지 않은 시스템, 또는 탐색적 변경

1. **먼저 전체 시스템 문서화**
2. **전체 컨텍스트로 PRD 생성**
3. **더 철저함** - 모든 것을 캡처

### 접근 방식 A: PRD 우선 워크플로우 (권장)

#### 1단계: 먼저 요구사항 정의

**Gemini Web에서 (flattened-codebase.xml이 업로드된 상태에서):**

```bash
@pm
*create-brownfield-prd
```

PM은 다음을 수행합니다:

- **개선 요구사항에 대해 질문**
- **현재 상태를 이해하기 위해 코드베이스 탐색**
- **문서화가 필요한 영향받는 영역 식별**
- **명확한 범위로 집중된 PRD 생성**

**주요 장점**: PRD가 모노레포/대규모 코드베이스에서 실제로 문서화가 필요한 부분을 식별합니다!

#### 2단계: 집중된 문서화

**여전히 Gemini Web에서, 이제 PRD 컨텍스트와 함께:**

```bash
@architect
*document-project
```

분석가는 다음을 수행합니다:

- **PRD가 제공되지 않은 경우 초점에 대해 질문**
- **옵션 제공**: PRD 생성, 요구사항 제공, 또는 개선사항 설명
- **범위를 이해하기 위해 PRD/설명 참조**
- **PRD 또는 설명에서 식별된 관련 모듈에 집중**
- **관련 없는 영역 건너뛰기**로 문서를 간결하게 유지
- **모든 환경에 대해 하나의 아키텍처 문서 생성**

분석가가 생성하는 것:

- **fullstack-architecture 템플릿을 따르는 하나의 포괄적인 아키텍처 문서**
- **단일 파일에서 모든 시스템 측면 다룸**
- **`docs/project-architecture.md`로 쉽게 복사 및 저장**
- **원하는 경우 나중에 IDE에서 샤딩 가능**

예를 들어, "사용자 서비스에 결제 처리 추가"라고 말하면:

- 문서화 대상: 사용자 서비스, API 엔드포인트, 데이터베이스 스키마, 결제 통합
- 결제 관련 코드 경로만 표시하는 집중된 소스 트리 생성
- 건너뛰기: 관리자 패널, 보고 모듈, 관련 없는 마이크로서비스

### 접근 방식 B: 문서 우선 워크플로우

#### 1단계: 기존 시스템 문서화

**최선의 접근 방식 - 1M+ 컨텍스트의 Gemini Web**:

1. **Gemini Web으로 이동** (gemini.google.com)
2. **프로젝트 업로드**:
   - **옵션 A**: GitHub 리포지토리 URL 직접 붙여넣기
   - **옵션 B**: flattened-codebase.xml 파일 업로드
3. **분석가 에이전트 로드**: `dist/agents/architect.txt` 업로드
4. **문서화 실행**: `*document-project` 입력

분석가가 모든 것에 대한 포괄적인 문서를 생성합니다.

#### 2단계: 개선사항 계획

##### 옵션 A: 전체 브라운필드 워크플로우 (주요 변경사항에 권장)

**1. 브라운필드 PRD 생성**:

```bash
@pm
*create-brownfield-prd
```

PM 에이전트는 다음을 수행합니다:

- **1단계의 기존 문서 분석**
- **특정 개선 세부사항 요청**
- **복잡성 평가** 및 접근 방식 권장
- **개선을 위한 에픽/스토리 구조 생성**
- **위험 및 통합 지점 식별**

**PM 에이전트가 프로젝트 컨텍스트를 얻는 방법**:

- Gemini Web에서: 1단계 문서화에서 이미 전체 프로젝트 컨텍스트 보유
- IDE에서: "기존 프로젝트 문서의 경로를 제공해 주세요"라고 질문

**만날 주요 프롬프트**:

- "추가하려는 특정 개선사항이나 기능은 무엇인가요?"
- "통합해야 하는 기존 시스템이나 API가 있나요?"
- "우리가 존중해야 할 중요한 제약사항은 무엇인가요?"
- "일정과 팀 규모는 어떻게 되나요?"

**2. 브라운필드 아키텍처 생성**:

```bash
@architect
*create-brownfield-architecture
```

아키텍트는 다음을 수행합니다:

- **브라운필드 PRD 검토**
- **통합 전략 설계**
- **필요한 경우 마이그레이션 접근 방식 계획**
- **기술적 위험 식별**
- **호환성 요구사항 정의**

##### 옵션 B: 빠른 개선 (집중된 변경사항의 경우)

**전체 PRD 없이 단일 에픽의 경우**:

```bash
@pm
*create-brownfield-epic
```

사용 시기:

- 개선사항이 잘 정의되고 격리됨
- 기존 문서가 포괄적임
- 변경사항이 여러 시스템에 영향을 미치지 않음
- 빠른 처리가 필요함

**단일 스토리의 경우**:

```bash
@pm
*create-brownfield-story
```

사용 시기:

- 버그 수정 또는 작은 기능
- 매우 격리된 변경
- 아키텍처 영향 없음
- 명확한 구현 경로

### 3단계: 계획 아티팩트 검증

```bash
@po
*execute-checklist-po
```

PO는 다음을 보장합니다:

- 기존 시스템과의 호환성
- 계획된 중단 변경 없음
- 위험 완화 전략 마련
- 명확한 통합 접근 방식

### 4단계: 문서 저장 및 샤딩

1. PRD와 아키텍처를 다음과 같이 저장:
   docs/brownfield-prd.md
   docs/brownfield-architecture.md
2. 문서 샤딩:
   IDE에서

   ```bash
   @po
   shard docs/brownfield-prd.md
   ```

   ```bash
   @po
   shard docs/brownfield-architecture.md
   ```

### 5단계: 개발로 전환

**[<ins>향상된 IDE 개발 워크플로우</ins>](enhanced-ide-development-workflow.md)를 따르세요**

## 브라운필드 모범 사례

### 1. 항상 먼저 문서화

코드베이스를 안다고 생각하더라도:

- 현재 상태를 캡처하기 위해 `document-project` 실행
- AI 에이전트에게 이 컨텍스트가 필요함
- 문서화되지 않은 패턴 발견

### 2. 기존 패턴 존중

브라운필드 템플릿은 특히 다음을 찾습니다:

- 현재 코딩 규칙
- 기존 아키텍처 패턴
- 기술 제약사항
- 팀 선호사항

### 3. 점진적 롤아웃 계획

브라운필드 변경사항은:

- 기능 플래그 지원
- 롤백 전략 계획
- 마이그레이션 스크립트 포함
- 하위 호환성 유지

### 4. 통합을 철저히 테스트

테스트 집중 영역:

- 통합 지점
- 기존 기능 (회귀)
- 성능 영향
- 데이터 마이그레이션

### 5. 변경사항 커뮤니케이션

문서화:

- 무엇이 변경되었고 이유
- 마이그레이션 지침
- 도입된 새 패턴
- 사용 중단 공지

## 일반적인 브라운필드 시나리오

### 시나리오 1: 새 기능 추가

1. 기존 시스템 문서화
2. 통합에 중점을 둔 브라운필드 PRD 생성
3. 호환성을 강조하는 아키텍처
4. 통합 작업을 포함하는 스토리

### 시나리오 2: 레거시 코드 현대화

1. 광범위한 문서화 단계
2. 마이그레이션 전략을 포함하는 PRD
3. 점진적 전환을 계획하는 아키텍처
4. Strangler Fig 패턴을 따르는 스토리

### 시나리오 3: 복잡한 시스템의 버그 수정

1. 관련 하위 시스템 문서화
2. 집중된 수정을 위해 `create-brownfield-story` 사용
3. 회귀 테스트 요구사항 포함
4. QA가 부작용 없음을 검증

### 시나리오 4: API 통합

1. 기존 API 패턴 문서화
2. PRD가 통합 요구사항 정의
3. 아키텍처가 일관된 패턴 보장
4. 스토리에 API 문서 업데이트 포함

## 문제 해결

### "AI가 내 코드베이스를 이해하지 못합니다"

**해결책**: 중요한 파일에 대한 더 구체적인 경로로 `document-project` 재실행

### "생성된 계획이 우리 패턴에 맞지 않습니다"

**해결책**: 계획 단계 전에 생성된 문서를 특정 규칙으로 업데이트

### "작은 변경에 너무 많은 보일러플레이트"

**해결책**: 전체 워크플로우 대신 `create-brownfield-story` 사용

### "통합 지점이 불분명합니다"

**해결책**: PRD 생성 중 더 많은 컨텍스트 제공, 특히 통합 시스템 강조

## 빠른 참조

### 브라운필드 전용 명령

```bash
# 기존 프로젝트 문서화
@architect → *document-project

# 개선 PRD 생성
@pm → *create-brownfield-prd

# 통합 중심의 아키텍처 생성
@architect → *create-brownfield-architecture

# 빠른 에픽 생성
@pm → *create-brownfield-epic

# 단일 스토리 생성
@pm → *create-brownfield-story
```

### 의사결정 트리

```text
대규모 코드베이스나 모노레포가 있나요?
├─ 예 → PRD 우선 접근 방식
│   └─ PRD 생성 → 영향받는 영역만 문서화
└─ 아니오 → 코드베이스를 잘 알고 있나요?
    ├─ 예 → PRD 우선 접근 방식
    └─ 아니오 → 문서 우선 접근 방식

여러 시스템에 영향을 미치는 주요 개선사항인가요?
├─ 예 → 전체 브라운필드 워크플로우
└─ 아니오 → 단순한 버그 수정 이상인가요?
    ├─ 예 → brownfield-create-epic
    └─ 아니오 → brownfield-create-story
```

## 결론

BMad-Method를 사용한 브라운필드 개발은 기존 시스템을 수정할 때 구조와 안전성을 제공합니다. 핵심은 문서화를 통해 포괄적인 컨텍스트를 제공하고, 통합 요구사항을 고려하는 전문 템플릿을 사용하며, 진행을 가능하게 하면서 기존 제약사항을 존중하는 워크플로우를 따르는 것입니다.

기억하세요: **먼저 문서화하고, 신중하게 계획하고, 안전하게 통합하세요**
