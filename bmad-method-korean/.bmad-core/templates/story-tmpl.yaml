template:
  id: story-template-v2
  name: 사용자 스토리 템플릿
  version: 2.0
  output:
    format: markdown
    filename: "docs/stories/{{epic_number}}-{{story_number}}-{{story_name}}.md"
    title: "스토리 {{epic_number}}.{{story_number}}: {{story_title}}"

workflow:
  mode: interactive
  validation: story-draft-checklist

agents:
  - owner: sm
    editors: [sm, po]
  - dev-section:
      owner: dev
      editors: [dev, qa]

sections:
  - id: header
    title: 스토리 헤더
    instruction: |
      스토리 메타데이터를 설정합니다. PRD의 에픽과 진행 상황을 참조하십시오.
    sections:
      - id: metadata
        type: key-value
        fields:
          - 상태: draft
          - 에픽: "{{epic_number}} - {{epic_title}}"
          - 예상시간: "2-4시간"
          - 우선순위: "{{priority}}"
          - 태그: "{{tags}}"

  - id: story
    title: 스토리
    instruction: |
      표준 사용자 스토리 형식을 사용하여 명확한 가치 진술을 작성합니다.
      PRD의 요구사항과 직접 연결되어야 합니다.
    template: |
      {{user_type}}로서,
      나는 {{action}}를 원합니다,
      {{benefit}}를 위해서.
    elicit: true

  - id: acceptance-criteria
    title: 승인 기준
    instruction: |
      명확하고 테스트 가능한 승인 기준을 정의합니다.
      각 기준은 구체적이고 검증 가능해야 합니다.
      PRD와 아키텍처 요구사항을 고려하십시오.
    type: numbered-list
    elicit: true
    examples:
      - "사용자는 유효한 이메일과 비밀번호로 로그인할 수 있다"
      - "잘못된 자격 증명은 명확한 오류 메시지를 표시한다"
      - "성공적인 로그인은 대시보드로 리디렉션한다"

  - id: dev-notes
    title: 개발 노트
    agent: sm
    instruction: |
      개발자를 위한 기술적 가이드라인과 힌트를 제공합니다.
      구현 세부사항을 지나치게 규정하지 마십시오.
    sections:
      - id: technical-notes
        title: 기술적 노트
        instruction: 아키텍처 참조, API 엔드포인트, 데이터 모델 등
      - id: dependencies
        title: 의존성
        instruction: 이 스토리가 의존하는 다른 스토리나 구성 요소
      - id: considerations
        title: 고려사항
        instruction: 성능, 보안, UX 고려사항

  - id: test-requirements
    title: 테스트 요구사항
    instruction: |
      이 스토리에 필요한 테스트 유형과 시나리오를 지정합니다.
    sections:
      - id: unit-tests
        title: 단위 테스트
        instruction: 테스트해야 할 핵심 로직과 함수
      - id: integration-tests
        title: 통합 테스트
        instruction: API 엔드포인트, 데이터베이스 상호작용
      - id: e2e-tests
        title: E2E 테스트
        instruction: 사용자 워크플로우와 시나리오

  - id: dev-agent-record
    title: 개발 에이전트 기록
    agent: dev
    instruction: |
      이 섹션은 개발 에이전트가 작업 중에 업데이트합니다.
      다른 에이전트는 이 섹션을 수정하지 마십시오.
    sections:
      - id: tasks-checklist
        title: 작업 체크리스트
        instruction: 개발자가 완료 시 체크하는 구현 작업
        type: checklist
        template: |
          - [ ] 기능 구현
          - [ ] 단위 테스트 작성
          - [ ] 통합 테스트 작성
          - [ ] 코드 린팅 통과
          - [ ] 문서 업데이트
      
      - id: files-modified
        title: 수정된 파일
        instruction: 이 스토리에서 생성/수정/삭제된 파일 목록
        type: bullet-list
      
      - id: implementation-notes
        title: 구현 노트
        instruction: 개발 중 내린 기술적 결정과 트레이드오프
      
      - id: test-results
        title: 테스트 결과
        instruction: 테스트 실행 요약과 커버리지

  - id: qa-section
    title: QA 섹션
    agent: qa
    condition: 스토리가 '리뷰 준비' 상태일 때
    sections:
      - id: qa-review
        title: QA 리뷰
        instruction: QA 엔지니어의 코드 리뷰와 테스트 결과
      - id: issues-found
        title: 발견된 이슈
        instruction: 버그, 개선사항, 또는 우려사항
      - id: qa-signoff
        title: QA 승인
        instruction: QA 승인 상태와 조건

  - id: completion
    title: 완료
    sections:
      - id: definition-of-done
        title: 완료 정의
        instruction: 이 스토리가 완료로 간주되기 위한 체크리스트
        type: checklist
        template: |
          - [ ] 모든 승인 기준 충족
          - [ ] 코드 리뷰 완료
          - [ ] 테스트 작성 및 통과
          - [ ] 문서 업데이트
          - [ ] QA 승인
      
      - id: deployment-notes
        title: 배포 노트
        instruction: 특별한 배포 고려사항이나 단계
